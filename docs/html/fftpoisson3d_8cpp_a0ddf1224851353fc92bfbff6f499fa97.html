<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HIP: main</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HIP<span id="projectnumber">&#160;0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="fftpoisson3d_8cpp.html">fftpoisson3d.cpp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="contents">
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td valign="top">
      <div class="navtab">
        <table>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a594b2d1b87046b64391a64d5d9cfd836.html#a594b2d1b87046b64391a64d5d9cfd836">exactSolution</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9.html#aaf41965393ffaedeec1441c5bc1c04e9">HIP_CHECK</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a2381dfa0eab8155c67775aa5d11c46f0.html#a2381dfa0eab8155c67775aa5d11c46f0">HIPFFT_CHECK</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">initRhsKernel</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a00a5985f55e3aaf7364c28006bb82492.html#a00a5985f55e3aaf7364c28006bb82492">L</a></td></tr>
          <tr><td class="navtabHL"><a class="navtab" href="fftpoisson3d_8cpp_a0ddf1224851353fc92bfbff6f499fa97.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a08837313dac9640e87d5c863bdda5d56.html#a08837313dac9640e87d5c863bdda5d56">N_RUNS</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_ac6b20696533fcd3fb731d0f87534b674.html#ac6b20696533fcd3fb731d0f87534b674">normalizeKernel</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a299aabc5fc8285cbf99025330a3d0d0d.html#a299aabc5fc8285cbf99025330a3d0d0d">PI</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a21f9f47c815b1b1c39fa1bd57bfd9149.html#a21f9f47c815b1b1c39fa1bd57bfd9149">poissonFourierKernel</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_ae64056deb2c56c72d016425bdda4fc99.html#ae64056deb2c56c72d016425bdda4fc99">poissonSolverCpu</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_af2aa3a20642270ff6717216d4355ef0a.html#af2aa3a20642270ff6717216d4355ef0a">poissonSolverGpu</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="fftpoisson3d_8cpp_a0a5f1ebe680786caa78e2398d2aef484.html#a0a5f1ebe680786caa78e2398d2aef484">rhsFunction</a></td></tr>
        </table>
      </div>
   </td>
   <td valign="top" class="mempage">
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">int</a> main </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">int</a>&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">char</a> *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Entry point of the 3D FFT-based Poisson solver. </p>

<p class="definition">Definition at line <a class="el" href="fftpoisson3d_8cpp_source.html#l00498">498</a> of file <a class="el" href="fftpoisson3d_8cpp_source.html">fftpoisson3d.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  499</span>{</div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">argc</a> != 4) {</div>
<div class="line"><span class="lineno">  501</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">argv</a>[0] &lt;&lt; <span class="stringliteral">&quot; Nx Ny Nz\n&quot;</span>;</div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">EXIT_FAILURE</a>;</div>
<div class="line"><span class="lineno">  503</span>    }</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a> = 0, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a> = 0, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a> = 0;</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Nx</a> = std::stoll(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">argv</a>[1]);</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Ny</a> = std::stoll(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">argv</a>[2]);</div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Nz</a> = std::stoll(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">argv</a>[3]);</div>
<div class="line"><span class="lineno">  511</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Nx</a> &lt;= 0 || <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Ny</a> &lt;= 0 || <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Nz</a> &lt;= 0) {</div>
<div class="line"><span class="lineno">  512</span>            std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: Nx, Ny, Nz must be positive integers.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  513</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">EXIT_FAILURE</a>;</div>
<div class="line"><span class="lineno">  514</span>        }</div>
<div class="line"><span class="lineno">  515</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Nx</a>);</div>
<div class="line"><span class="lineno">  516</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Ny</a>);</div>
<div class="line"><span class="lineno">  517</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">temp_Nz</a>);</div>
<div class="line"><span class="lineno">  518</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">e</a>) {</div>
<div class="line"><span class="lineno">  519</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Invalid input: &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">e</a>.what() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  520</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">EXIT_FAILURE</a>;</div>
<div class="line"><span class="lineno">  521</span>    }</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a>) * <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a> * <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a>;</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Running FFT Poisson solver with grid: &quot;</span></div>
<div class="line"><span class="lineno">  526</span>          &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a> &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a> &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>    <span class="comment">// ---------------- GPU SETUP ----------------</span></div>
<div class="line"><span class="lineno">  529</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipfftHandle</a> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">plan_gpu</a>;</div>
<div class="line"><span class="lineno">  530</span>    <a class="code hl_define" href="fftpoisson3d_8cpp_a2381dfa0eab8155c67775aa5d11c46f0.html#a2381dfa0eab8155c67775aa5d11c46f0">HIPFFT_CHECK</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipfftPlan3d</a>(&amp;<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">plan_gpu</a>, (<span class="keywordtype">int</span>)<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a>, (<span class="keywordtype">int</span>)<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a>, (<span class="keywordtype">int</span>)<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">HIPFFT_Z2Z</a>));</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipfftDoubleComplex</a>* <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">d_output</a>;</div>
<div class="line"><span class="lineno">  533</span>    <a class="code hl_define" href="fftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9.html#aaf41965393ffaedeec1441c5bc1c04e9">HIP_CHECK</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipMalloc</a>(&amp;<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">d_output</a>, <a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a> * <span class="keyword">sizeof</span>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipfftDoubleComplex</a>)));</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>    <span class="comment">// ---------------- GPU WARM-UP ----------------</span></div>
<div class="line"><span class="lineno">  536</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_af2aa3a20642270ff6717216d4355ef0a.html#af2aa3a20642270ff6717216d4355ef0a">poissonSolverGpu</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">plan_gpu</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">d_output</a>);</div>
<div class="line"><span class="lineno">  537</span>    <a class="code hl_define" href="fftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9.html#aaf41965393ffaedeec1441c5bc1c04e9">HIP_CHECK</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipDeviceSynchronize</a>());</div>
<div class="line"><span class="lineno">  538</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;GPU warm-up completed.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">total_gpu_time</a> = 0.0;</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a> = 0; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a> &lt; <a class="code hl_variable" href="fftpoisson3d_8cpp_a08837313dac9640e87d5c863bdda5d56.html#a08837313dac9640e87d5c863bdda5d56">N_RUNS</a>; ++<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a>) {</div>
<div class="line"><span class="lineno">  542</span>        <span class="keyword">auto</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t0_gpu</a> = std::chrono::high_resolution_clock::now();</div>
<div class="line"><span class="lineno">  543</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_af2aa3a20642270ff6717216d4355ef0a.html#af2aa3a20642270ff6717216d4355ef0a">poissonSolverGpu</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">plan_gpu</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">d_output</a>);</div>
<div class="line"><span class="lineno">  544</span>        <a class="code hl_define" href="fftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9.html#aaf41965393ffaedeec1441c5bc1c04e9">HIP_CHECK</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipDeviceSynchronize</a>());</div>
<div class="line"><span class="lineno">  545</span>        <span class="keyword">auto</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t1_gpu</a> = std::chrono::high_resolution_clock::now();</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>        std::chrono::duration&lt;double&gt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">dt_gpu</a> = <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t1_gpu</a> - <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t0_gpu</a>;</div>
<div class="line"><span class="lineno">  548</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">total_gpu_time</a> += <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">dt_gpu</a>.count();</div>
<div class="line"><span class="lineno">  549</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;GPU run &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a>+1 &lt;&lt; <span class="stringliteral">&quot; time = &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">dt_gpu</a>.count() &lt;&lt; <span class="stringliteral">&quot; s\n&quot;</span>;</div>
<div class="line"><span class="lineno">  550</span>    }</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">avg_gpu_time</a> = <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">total_gpu_time</a> / <a class="code hl_variable" href="fftpoisson3d_8cpp_a08837313dac9640e87d5c863bdda5d56.html#a08837313dac9640e87d5c863bdda5d56">N_RUNS</a>;</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    <span class="comment">// Copy GPU result to host in vector&lt;double&gt;</span></div>
<div class="line"><span class="lineno">  555</span>    std::vector&lt;double&gt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_data</a>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>);</div>
<div class="line"><span class="lineno">  556</span>    { <span class="comment">// Use the scope to free h_temp.</span></div>
<div class="line"><span class="lineno">  557</span>        std::vector&lt;hipfftDoubleComplex&gt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_temp</a>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>);</div>
<div class="line"><span class="lineno">  558</span>        <a class="code hl_define" href="fftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9.html#aaf41965393ffaedeec1441c5bc1c04e9">HIP_CHECK</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipMemcpy</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_temp</a>.data(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">d_output</a>, <a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a> * <span class="keyword">sizeof</span>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipfftDoubleComplex</a>), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipMemcpyDeviceToHost</a>));</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>        std::transform(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_temp</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_temp</a>.end(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_data</a>.begin(),</div>
<div class="line"><span class="lineno">  561</span>                    [](<span class="keyword">const</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipfftDoubleComplex</a>&amp; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">c</a>){ return c.x; });</div>
<div class="line"><span class="lineno">  562</span>    }</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    <a class="code hl_define" href="fftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9.html#aaf41965393ffaedeec1441c5bc1c04e9">HIP_CHECK</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipFree</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">d_output</a>));</div>
<div class="line"><span class="lineno">  565</span>    <a class="code hl_define" href="fftpoisson3d_8cpp_a2381dfa0eab8155c67775aa5d11c46f0.html#a2381dfa0eab8155c67775aa5d11c46f0">HIPFFT_CHECK</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">hipfftDestroy</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">plan_gpu</a>));</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    <span class="comment">// ---------------- CPU SETUP ----------------</span></div>
<div class="line"><span class="lineno">  568</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_init_threads</a>();</div>
<div class="line"><span class="lineno">  569</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_plan_with_nthreads</a>(<span class="keywordtype">int</span>(std::thread::hardware_concurrency()));</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>    std::ostringstream <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_name</a>;</div>
<div class="line"><span class="lineno">  572</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_name</a> &lt;&lt; <span class="stringliteral">&quot;fftpoisson3d_fftw_wisdom_&quot;</span></div>
<div class="line"><span class="lineno">  573</span>                &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a> &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><span class="lineno">  574</span>    std::string <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_file</a> = <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_name</a>.str();</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_loaded</a> = <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_import_wisdom_from_filename</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_file</a>.c_str());</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_loaded</a>)</div>
<div class="line"><span class="lineno">  578</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;CPU: FFTW wisdom loaded.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  579</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  580</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;CPU: No FFTW wisdom found, plans will be measured.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_complex</a>* <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_data</a> = (<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_complex</a>*) <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_malloc</a>(<span class="keyword">sizeof</span>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_complex</a>) * <a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>);</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    <span class="comment">// ---------------- CPU WARM-UP ----------------</span></div>
<div class="line"><span class="lineno">  585</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_ae64056deb2c56c72d016425bdda4fc99.html#ae64056deb2c56c72d016425bdda4fc99">poissonSolverCpu</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_data</a>);</div>
<div class="line"><span class="lineno">  586</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;CPU warm-up completed.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">total_cpu_time</a> = 0.0;</div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a> = 0; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a> &lt; <a class="code hl_variable" href="fftpoisson3d_8cpp_a08837313dac9640e87d5c863bdda5d56.html#a08837313dac9640e87d5c863bdda5d56">N_RUNS</a>; ++<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a>) {</div>
<div class="line"><span class="lineno">  590</span>        <span class="keyword">auto</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t0_cpu</a> = std::chrono::high_resolution_clock::now();</div>
<div class="line"><span class="lineno">  591</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_ae64056deb2c56c72d016425bdda4fc99.html#ae64056deb2c56c72d016425bdda4fc99">poissonSolverCpu</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_data</a>);</div>
<div class="line"><span class="lineno">  592</span>        <span class="keyword">auto</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t1_cpu</a> = std::chrono::high_resolution_clock::now();</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>        std::chrono::duration&lt;double&gt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">dt_cpu</a> = <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t1_cpu</a> - <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">t0_cpu</a>;</div>
<div class="line"><span class="lineno">  595</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">total_cpu_time</a> += <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">dt_cpu</a>.count();</div>
<div class="line"><span class="lineno">  596</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;CPU run &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">run</a>+1 &lt;&lt; <span class="stringliteral">&quot; time = &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">dt_cpu</a>.count() &lt;&lt; <span class="stringliteral">&quot; s\n&quot;</span>;</div>
<div class="line"><span class="lineno">  597</span>    }</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">avg_cpu_time</a> = <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">total_cpu_time</a> / <a class="code hl_variable" href="fftpoisson3d_8cpp_a08837313dac9640e87d5c863bdda5d56.html#a08837313dac9640e87d5c863bdda5d56">N_RUNS</a>;</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">// Copy CPU solution real part into vector&lt;double&gt; using parallel STL</span></div>
<div class="line"><span class="lineno">  602</span>    std::vector&lt;double&gt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_cpu_data</a>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>);</div>
<div class="line"><span class="lineno">  603</span>    std::transform(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_data</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_data</a> + <a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_cpu_data</a>.begin(),</div>
<div class="line"><span class="lineno">  604</span>                   [](<span class="keyword">const</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_complex</a>&amp; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">c</a>){ return c[0]; });</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_loaded</a>) {</div>
<div class="line"><span class="lineno">  607</span>        <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_export_wisdom_to_filename</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_file</a>.c_str());</div>
<div class="line"><span class="lineno">  608</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;FFTW wisdom saved to &quot;</span> &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">wisdom_file</a> &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  609</span>    }</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_cleanup_threads</a>();</div>
<div class="line"><span class="lineno">  612</span>    <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">fftw_free</a>(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_data</a>);</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    <span class="comment">// ---------------- ERROR CALCULATION ----------------</span></div>
<div class="line"><span class="lineno">  615</span>    std::vector&lt;double&gt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_errors</a>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_errors</a>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>);</div>
<div class="line"><span class="lineno">  616</span>    std::vector&lt;size_t&gt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>);</div>
<div class="line"><span class="lineno">  617</span>    std::iota(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.end(), 0);</div>
<div class="line"><span class="lineno">  618</span>    </div>
<div class="line"><span class="lineno">  619</span>    <span class="comment">// ---------------- PRECOMPUTE EXACT SOLUTION ----------------</span></div>
<div class="line"><span class="lineno">  620</span>    std::transform(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.end(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>.begin(),</div>
<div class="line"><span class="lineno">  621</span>        [<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nx</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Ny</a>, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">Nz</a>](<span class="keywordtype">size_t</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">idx</a>){</div>
<div class="line"><span class="lineno">  622</span>            size_t i = idx / (Ny * Nz);</div>
<div class="line"><span class="lineno">  623</span>            size_t j = (idx / Nz) % Ny;</div>
<div class="line"><span class="lineno">  624</span>            size_t k = idx % Nz;</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>            return exactSolution(</div>
<div class="line"><span class="lineno">  627</span>                L * static_cast&lt;double&gt;(i) / static_cast&lt;double&gt;(Nx),</div>
<div class="line"><span class="lineno">  628</span>                L * static_cast&lt;double&gt;(j) / static_cast&lt;double&gt;(Ny),</div>
<div class="line"><span class="lineno">  629</span>                L * static_cast&lt;double&gt;(k) / static_cast&lt;double&gt;(Nz)</div>
<div class="line"><span class="lineno">  630</span>            );</div>
<div class="line"><span class="lineno">  631</span>        });</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>    <span class="comment">// ---------------- MEAN OF EXACT SOLUTION ----------------</span></div>
<div class="line"><span class="lineno">  634</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">mean_exact</a> =</div>
<div class="line"><span class="lineno">  635</span>        std::transform_reduce(</div>
<div class="line"><span class="lineno">  636</span>            std::execution::par,</div>
<div class="line"><span class="lineno">  637</span>            <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>.end(),</div>
<div class="line"><span class="lineno">  638</span>            0.0,</div>
<div class="line"><span class="lineno">  639</span>            std::plus&lt;&gt;(),</div>
<div class="line"><span class="lineno">  640</span>            [](<span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">v</a>){ return v; }</div>
<div class="line"><span class="lineno">  641</span>        ) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>);</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="comment">// ---------------- ZERO-MEAN EXACT SOLUTION ----------------</span></div>
<div class="line"><span class="lineno">  645</span>    std::for_each(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>.end(),</div>
<div class="line"><span class="lineno">  646</span>        [<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">mean_exact</a>](<span class="keywordtype">double</span>&amp; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">v</a>){</div>
<div class="line"><span class="lineno">  647</span>            v -= mean_exact;</div>
<div class="line"><span class="lineno">  648</span>        });</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>    std::transform(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.end(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_errors</a>.begin(),</div>
<div class="line"><span class="lineno">  651</span>        [&amp;<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_data</a>, &amp;<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>](<span class="keywordtype">size_t</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">idx</a>){</div>
<div class="line"><span class="lineno">  652</span>            return std::abs(h_data[idx] - exact_u[idx]);</div>
<div class="line"><span class="lineno">  653</span>        });</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>    std::transform(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">indices</a>.end(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_errors</a>.begin(),</div>
<div class="line"><span class="lineno">  656</span>        [&amp;<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">h_cpu_data</a>, &amp;<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">exact_u</a>](<span class="keywordtype">size_t</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">idx</a>){</div>
<div class="line"><span class="lineno">  657</span>            return std::abs(h_cpu_data[idx] - exact_u[idx]);</div>
<div class="line"><span class="lineno">  658</span>        });</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_l2</a> = std::transform_reduce(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_errors</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_errors</a>.end(), 0.0, std::plus&lt;&gt;(), [](<span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">e</a>){ return e*e; });</div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_l2</a> = std::transform_reduce(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_errors</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_errors</a>.end(), 0.0, std::plus&lt;&gt;(), [](<span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">e</a>){ return e*e; });</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_max</a> = *std::max_element(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_errors</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_errors</a>.end());</div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_max</a> = *std::max_element(std::execution::par, <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_errors</a>.begin(), <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_errors</a>.end());</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>    <span class="comment">// ---------------- PRINT COMPARISON ----------------</span></div>
<div class="line"><span class="lineno">  667</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\n================== GPU vs CPU Comparison ==================\n&quot;</span>;</div>
<div class="line"><span class="lineno">  668</span>    std::cout &lt;&lt; std::left </div>
<div class="line"><span class="lineno">  669</span>              &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;Solver&quot;</span> &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  670</span>              &lt;&lt; std::right &lt;&lt; std::setw(12) &lt;&lt; <span class="stringliteral">&quot;Avg Time (s)&quot;</span> &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  671</span>              &lt;&lt; std::setw(16) &lt;&lt; <span class="stringliteral">&quot;L2 Error&quot;</span> &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  672</span>              &lt;&lt; std::setw(16) &lt;&lt; <span class="stringliteral">&quot;Max Error&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;-------|--------------|------------------|-----------------\n&quot;</span>;</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>    std::cout &lt;&lt; std::left &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;GPU&quot;</span> &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  677</span>              &lt;&lt; std::right &lt;&lt; std::setw(12) &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">avg_gpu_time</a> &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  678</span>              &lt;&lt; std::setw(16) &lt;&lt; std::scientific &lt;&lt; std::setprecision(6) &lt;&lt; std::sqrt(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_l2</a>/(<span class="keywordtype">double</span>)<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>) &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  679</span>              &lt;&lt; std::setw(16) &lt;&lt; std::scientific &lt;&lt; std::setprecision(6) &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">gpu_max</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>    std::cout &lt;&lt; std::left &lt;&lt; std::setw(6) &lt;&lt; <span class="stringliteral">&quot;CPU&quot;</span> &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  682</span>              &lt;&lt; std::right &lt;&lt; std::setw(12) &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">avg_cpu_time</a> &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  683</span>              &lt;&lt; std::setw(16) &lt;&lt; std::scientific &lt;&lt; std::setprecision(6) &lt;&lt; std::sqrt(<a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_l2</a>/<span class="keywordtype">double</span>(<a class="code hl_variable" href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a>)) &lt;&lt; <span class="stringliteral">&quot; | &quot;</span></div>
<div class="line"><span class="lineno">  684</span>              &lt;&lt; std::setw(16) &lt;&lt; std::scientific &lt;&lt; std::setprecision(6) &lt;&lt; <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">cpu_max</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;===========================================================\n&quot;</span>;</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">EXIT_SUCCESS</a>;</div>
<div class="line"><span class="lineno">  689</span>}</div>
<div class="ttc" id="afftpoisson3d_8cpp_a08837313dac9640e87d5c863bdda5d56_html_a08837313dac9640e87d5c863bdda5d56"><div class="ttname"><a href="fftpoisson3d_8cpp_a08837313dac9640e87d5c863bdda5d56.html#a08837313dac9640e87d5c863bdda5d56">N_RUNS</a></div><div class="ttdeci">constexpr size_t N_RUNS</div><div class="ttdoc">Number of timing runs for averaging.</div><div class="ttdef"><b>Definition</b> <a href="fftpoisson3d_8cpp_source.html#l00225">fftpoisson3d.cpp:225</a></div></div>
<div class="ttc" id="afftpoisson3d_8cpp_a2381dfa0eab8155c67775aa5d11c46f0_html_a2381dfa0eab8155c67775aa5d11c46f0"><div class="ttname"><a href="fftpoisson3d_8cpp_a2381dfa0eab8155c67775aa5d11c46f0.html#a2381dfa0eab8155c67775aa5d11c46f0">HIPFFT_CHECK</a></div><div class="ttdeci">#define HIPFFT_CHECK(status)</div><div class="ttdoc">Macro to check hipFFT API errors.</div><div class="ttdef"><b>Definition</b> <a href="fftpoisson3d_8cpp_source.html#l00210">fftpoisson3d.cpp:210</a></div></div>
<div class="ttc" id="afftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67_html_a34e09da5dc935815f1e89458afc57b67"><div class="ttname"><a href="fftpoisson3d_8cpp_a34e09da5dc935815f1e89458afc57b67.html#a34e09da5dc935815f1e89458afc57b67">initRhsKernel</a></div><div class="ttdeci">static __global__ void initRhsKernel(hipfftDoubleComplex *d_data, size_t Nx, size_t Ny, size_t Nz)</div><div class="ttdoc">Initializes the RHS on the GPU.</div><div class="ttdef"><b>Definition</b> <a href="fftpoisson3d_8cpp_source.html#l00316">fftpoisson3d.cpp:316</a></div></div>
<div class="ttc" id="afftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9_html_aaf41965393ffaedeec1441c5bc1c04e9"><div class="ttname"><a href="fftpoisson3d_8cpp_aaf41965393ffaedeec1441c5bc1c04e9.html#aaf41965393ffaedeec1441c5bc1c04e9">HIP_CHECK</a></div><div class="ttdeci">#define HIP_CHECK(status)</div><div class="ttdoc">Macro to check HIP runtime API errors.</div><div class="ttdef"><b>Definition</b> <a href="fftpoisson3d_8cpp_source.html#l00195">fftpoisson3d.cpp:195</a></div></div>
<div class="ttc" id="afftpoisson3d_8cpp_ae64056deb2c56c72d016425bdda4fc99_html_ae64056deb2c56c72d016425bdda4fc99"><div class="ttname"><a href="fftpoisson3d_8cpp_ae64056deb2c56c72d016425bdda4fc99.html#ae64056deb2c56c72d016425bdda4fc99">poissonSolverCpu</a></div><div class="ttdeci">static void poissonSolverCpu(size_t Nx, size_t Ny, size_t Nz, fftw_complex *h_data)</div><div class="ttdoc">Solves the Poisson problem on the CPU using FFTW.</div><div class="ttdef"><b>Definition</b> <a href="fftpoisson3d_8cpp_source.html#l00423">fftpoisson3d.cpp:423</a></div></div>
<div class="ttc" id="afftpoisson3d_8cpp_af2aa3a20642270ff6717216d4355ef0a_html_af2aa3a20642270ff6717216d4355ef0a"><div class="ttname"><a href="fftpoisson3d_8cpp_af2aa3a20642270ff6717216d4355ef0a.html#af2aa3a20642270ff6717216d4355ef0a">poissonSolverGpu</a></div><div class="ttdeci">static void poissonSolverGpu(size_t Nx, size_t Ny, size_t Nz, hipfftHandle fftPlan, hipfftDoubleComplex *d_solution)</div><div class="ttdoc">Solves the Poisson problem on the GPU.</div><div class="ttdef"><b>Definition</b> <a href="fftpoisson3d_8cpp_source.html#l00386">fftpoisson3d.cpp:386</a></div></div>
<div class="ttc" id="amontecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365_html_ade6c365880e00a7c1a8ea0dd9487d365"><div class="ttname"><a href="montecarlointegration_8cpp_ade6c365880e00a7c1a8ea0dd9487d365.html#ade6c365880e00a7c1a8ea0dd9487d365">N</a></div><div class="ttdeci">constexpr std::size_t N</div><div class="ttdoc">Total number of Monte Carlo samples.</div><div class="ttdef"><b>Definition</b> <a href="montecarlointegration_8cpp_source.html#l00070">montecarlointegration.cpp:70</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="fftpoisson3d_8cpp_source.html#l00195">HIP_CHECK</a>, <a class="el" href="fftpoisson3d_8cpp_source.html#l00210">HIPFFT_CHECK</a>, <a class="el" href="fftpoisson3d_8cpp_source.html#l00316">initRhsKernel()</a>, <a class="el" href="montecarlointegration_8cpp_source.html#l00070">N</a>, <a class="el" href="fftpoisson3d_8cpp_source.html#l00225">N_RUNS</a>, <a class="el" href="fftpoisson3d_8cpp_source.html#l00423">poissonSolverCpu()</a>, and <a class="el" href="fftpoisson3d_8cpp_source.html#l00386">poissonSolverGpu()</a>.</p>

</div>
</div>
    </td>
  </tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
